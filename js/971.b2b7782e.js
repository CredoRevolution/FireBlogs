"use strict";(self["webpackChunkfireblogss"]=self["webpackChunkfireblogss"]||[]).push([[971],{240:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"create-post"},[t("BlogCoverPreview",{directives:[{name:"show",rawName:"v-show",value:this.$store.state.blogPhotoPreview,expression:"this.$store.state.blogPhotoPreview"}]}),t("Loading",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}]}),t("div",{staticClass:"container"},[t("div",{staticClass:"err-message",class:{invisible:!e.error}},[t("p",[t("span",[e._v("Error:")]),e._v(e._s(this.errorMsg))])]),t("div",{staticClass:"blog-info"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.blogTitle,expression:"blogTitle"}],attrs:{type:"text",placeholder:"Enter Blog Title"},domProps:{value:e.blogTitle},on:{input:function(t){t.target.composing||(e.blogTitle=t.target.value)}}}),t("div",{staticClass:"upload-file"},[t("label",{attrs:{for:"blog-photo"}},[e._v("Upload Cover Photo")]),t("input",{ref:"blogPhoto",attrs:{type:"file",id:"blog-photo",accept:".png, .jpg, ,jpeg"},on:{change:e.fileChange}}),t("button",{staticClass:"preview",class:{"button-inactive":!this.$store.state.blogPhotoFileURL},on:{click:e.openPreview}},[e._v(" Preview Photo ")]),t("span",[e._v("File Chosen: "+e._s(this.$store.state.blogPhotoName))])])]),t("div",{staticClass:"editor"},[t("vue-editor",{attrs:{editorOptions:e.editorSettings,useCustomImageHandler:""},on:{"image-added":e.imageHandler},model:{value:e.blogHTML,callback:function(t){e.blogHTML=t},expression:"blogHTML"}})],1),t("div",{staticClass:"blog-actions"},[t("button",{on:{click:e.uploadBlog}},[e._v("Publish Blog")]),t("router-link",{staticClass:"router-button",attrs:{to:{name:"BlogPreview"}}},[e._v("Post Preview")])],1)])],1)},i=[],l=(o(4114),o(352)),r=o(7360),a=o(7844),n=o(7617),g=o(5166),h=o(9933),c=o.n(h);window.Quill=c();const d=o(5147)["default"];c().register("modules/imageResize",d);var u={name:"CreatePost",data(){return{file:null,error:null,errorMsg:null,loading:null,editorSettings:{modules:{imageResize:{}}}}},components:{BlogCoverPreview:l.A,Loading:r.A},methods:{fileChange(){this.file=this.$refs.blogPhoto.files[0];const e=this.file.name;this.$store.commit("fileNameChange",e),this.$store.commit("createFileURL",URL.createObjectURL(this.file))},openPreview(){this.$store.commit("openPhotoPreview")},imageHandler(e,t,o,s){const i=(0,a.c7)(),l=(0,a.KR)(i,`documents/blogPostPhotos/${e.name}`),r=(0,a.bp)(l,e);r.on("state_changed",(e=>{console.log(e)}),(e=>{console.log(e)}),(async()=>{const e=await(0,a.qk)(l);t.insertEmbed(o,"image",e),s()}))},uploadBlog(){if(0!==this.blogTitle.length&&0!==this.blogHTML.length){if(this.file){this.loading=!0;const e=(0,a.c7)(),t=(0,a.KR)(e,`documents/blogCoverPhotos/${this.blogCoverPhotoName}`),o=(0,a.bp)(t,this.file);o.on("state_changed",(e=>{console.log("snapshot")}),(e=>{console.log(e)}),(async()=>{const e=await(0,a.qk)(t),o=await Date.now(),s=(0,n.rJ)(g.A,"blogPosts");await(0,n.gS)(s,{blogCoverPhoto:e,blogCoverPhotoName:this.blogCoverPhotoName,blogTitle:this.blogTitle,blogHTML:this.blogHTML,blogId:o,profileId:this.profileId,date:o}),await this.$store.dispatch("getPosts"),this.loading=!1,this.$router.push({name:"ViewBlog",params:{blogid:o}})}))}this.error=!0,this.errorMsg="Please ensure you uploaded a blog cover photo!",setTimeout((()=>{this.error=!1,this.errorMsg=null}),5e3)}this.error=!0,this.errorMsg="Please ensure Blog Title & Blog Post has been filled!",setTimeout((()=>{this.error=!1,this.errorMsg=null}),5e3)}},computed:{profileId(){return this.$store.state.profileId},blogCoverPhotoName(){return this.$store.state.blogPhotoName},blogTitle:{get(){return this.$store.state.blogTitle},set(e){this.$store.commit("updateBlogTitle",e)}},blogHTML:{get(){return this.$store.state.blogHTML},set(e){this.$store.commit("newBlogPost",e)}}}},b=u,m=o(1656),v=(0,m.A)(b,s,i,!1,null,null,null),p=v.exports}}]);
//# sourceMappingURL=971.b2b7782e.js.map