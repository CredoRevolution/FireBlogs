"use strict";(self["webpackChunkfireblogss"]=self["webpackChunkfireblogss"]||[]).push([[419],{2107:function(t,e,o){o.r(e),o.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create-post"},[e("BlogCoverPreview",{directives:[{name:"show",rawName:"v-show",value:this.$store.state.blogPhotoPreview,expression:"this.$store.state.blogPhotoPreview"}]}),e("Loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),e("div",{staticClass:"container"},[e("div",{staticClass:"err-message",class:{invisible:!t.error}},[e("p",[e("span",[t._v("Error:")]),t._v(t._s(this.errorMsg))])]),e("div",{staticClass:"blog-info"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.blogTitle,expression:"blogTitle"}],attrs:{type:"text",placeholder:"Enter Blog Title"},domProps:{value:t.blogTitle},on:{input:function(e){e.target.composing||(t.blogTitle=e.target.value)}}}),e("div",{staticClass:"upload-file"},[e("label",{attrs:{for:"blog-photo"}},[t._v("Upload Cover Photo")]),e("input",{ref:"blogPhoto",attrs:{type:"file",id:"blog-photo",accept:".png, .jpg, ,jpeg"},on:{change:t.fileChange}}),e("button",{staticClass:"preview",class:{"button-inactive":!this.$store.state.blogPhotoFileURL},on:{click:t.openPreview}},[t._v(" Preview Photo ")]),e("span",[t._v("File Chosen: "+t._s(this.$store.state.blogPhotoName))])])]),e("div",{staticClass:"editor"},[e("vue-editor",{attrs:{editorOptions:t.editorSettings,useCustomImageHandler:""},on:{"image-added":t.imageHandler},model:{value:t.blogHTML,callback:function(e){t.blogHTML=e},expression:"blogHTML"}})],1),e("div",{staticClass:"blog-actions"},[e("button",{on:{click:t.updatedBlog}},[t._v("Save Changes")]),e("router-link",{staticClass:"router-button",attrs:{to:{name:"BlogPreview"}}},[t._v("Preview Changes")])],1)])],1)},i=[],l=(o(4114),o(8111),o(2489),o(352)),r=o(7360),a=o(7844),n=o(7617),g=o(5166),h=o(9933),c=o.n(h);window.Quill=c();const d=o(5147)["default"];c().register("modules/imageResize",d);var u={name:"CreatePost",data(){return{file:null,error:null,errorMsg:null,loading:null,routeId:null,currentBlog:null,editorSettings:{modules:{imageResize:{}}}}},components:{BlogCoverPreview:l.A,Loading:r.A},async mounted(){this.routeId=this.$route.params.blogid,this.currentBlog=this.$store.state.blogPosts.filter((t=>t.blogId==this.routeId)),this.$store.commit("setBlogState",this.currentBlog[0])},methods:{fileChange(){this.file=this.$refs.blogPhoto.files[0];const t=this.file.name;this.$store.commit("fileNameChange",t),this.$store.commit("createFileURL",URL.createObjectURL(this.file))},openPreview(){this.$store.commit("openPhotoPreview")},imageHandler(t,e,o,s){const i=(0,a.c7)(),l=(0,a.KR)(i,`documents/blogPostPhotos/${t.name}`),r=(0,a.bp)(l,t);r.on("state_changed",(t=>{console.log(t)}),(t=>{console.log(t)}),(async()=>{const t=await(0,a.qk)(l);e.insertEmbed(o,"image",t),s()}))},async updatedBlog(){if(0!==this.blogTitle.length&&0!==this.blogHTML.length){const t=(0,n.rJ)(g.A,"blogPosts"),e=(0,n.P)(t,(0,n._M)("blogId","==",this.routeId)),o=await(0,n.GG)(e);if(console.log(o),this.file){this.loading=!0;const t=(0,a.c7)(),e=(0,a.KR)(t,`documents/blogCoverPhotos/${this.blogCoverPhotoName}`),s=(0,a.bp)(e,this.file);return s.on("state_changed",(t=>{console.log("snapshot")}),(t=>{console.log(t)}),(async()=>{const t=await(0,a.qk)(e);if(!o.empty){const e=o.docs[0],s=(0,n.H9)(g.A,"blogPosts",e.id);await(0,n.mZ)(s,{blogCoverPhoto:t,blogCoverPhotoName:this.blogCoverPhotoName,blogTitle:this.blogTitle,blogHTML:this.blogHTML}),await this.$store.dispatch("getPosts"),this.$router.push({name:"ViewBlog",params:{blogid:this.routeId}})}})),void(this.loading=!1)}if(!o.empty){this.loading=!0;const t=o.docs[0],e=(0,n.H9)(g.A,"blogPosts",t.id);return await(0,n.mZ)(e,{blogTitle:this.blogTitle,blogHTML:this.blogHTML}),await this.$store.dispatch("getPosts",t),this.loading=!1,void this.$router.push({name:"ViewBlog",params:{blogid:this.routeId}})}}this.error=!0,this.errorMsg="Please ensure Blog Title & Blog Post has been filled!",setTimeout((()=>{this.error=!1,this.errorMsg=null}),5e3)}},computed:{profileId(){return this.$store.state.profileId},blogCoverPhotoName(){return this.$store.state.blogPhotoName},blogTitle:{get(){return this.$store.state.blogTitle},set(t){this.$store.commit("updateBlogTitle",t)}},blogHTML:{get(){return this.$store.state.blogHTML},set(t){this.$store.commit("newBlogPost",t)}}}},b=u,m=o(1656),v=(0,m.A)(b,s,i,!1,null,null,null),p=v.exports}}]);
//# sourceMappingURL=419.fb01be66.js.map